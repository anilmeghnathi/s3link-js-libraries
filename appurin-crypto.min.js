Appurin.namespace("Appurin.crypto"),Appurin.crypto.encrypt=function(r,e){var t=CryptoJS.lib.WordArray.random(16),t={mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7,iv:t},e=CryptoJS.AES.encrypt(r,CryptoJS.enc.Base64.parse(e),t),t=Appurin.crypto.base64ToArrayBuffer(e.toString()),e=Appurin.crypto.base64ToArrayBuffer(e.iv.toString(CryptoJS.enc.Base64)),t=Appurin.crypto.appendBuffer(e,t);return Appurin.crypto.arrayBufferToBase64(t)},Appurin.crypto.decrypt=function(r,e){var t=Appurin.crypto.base64ToArrayBuffer(r),r=CryptoJS.enc.Base64.parse(Appurin.crypto.arrayBufferToBase64(t.slice(0,16))),t=Appurin.crypto.arrayBufferToBase64(t.slice(16,t.byteLength)),r={iv:r,mode:CryptoJS.mode.CBC};return CryptoJS.AES.decrypt(t,CryptoJS.enc.Base64.parse(e),r).toString(CryptoJS.enc.Utf8)},Appurin.crypto.base64ToArrayBuffer=function(r){for(var e=window.atob(r),t=e.length,p=new Uint8Array(t),n=0;n<t;n++)p[n]=e.charCodeAt(n);return p.buffer},Appurin.crypto.arrayBufferToBase64=function(r){return btoa(new Uint8Array(r).reduce(function(r,e){return r+String.fromCharCode(e)},""))},Appurin.crypto.appendBuffer=function(r,e){var t=new Uint8Array(r.byteLength+e.byteLength);return t.set(new Uint8Array(r),0),t.set(new Uint8Array(e),r.byteLength),t.buffer};